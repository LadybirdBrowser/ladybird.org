---
import { getCollection } from "astro:content";

const posts = await getCollection("posts");
posts.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

const visiblePosts = posts
  .filter((post) => post.data.type !== "Hidden")
  .slice(0, 6);
---

<section id="news" class="section">
  <div class="container">
    <h2 class="section-heading">News</h2>

    <div class="posts-list">
      {
        visiblePosts.map((post) => (
          <div class="post-row">
            <span class="post-date">
              {new Date(post.data.date).toISOString().slice(0, 10)}
            </span>
            <div class="post-info">
              <a href={`/posts/${post.slug}`}>{post.data.title}</a>
              <p>{post.data.description}</p>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<style>
  .posts-list {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .post-row {
    display: flex;
    gap: 20px;
    align-items: baseline;
  }

  .post-date {
    font-family: var(--font-mono);
    font-size: 13px;
    color: var(--text-muted);
    flex-shrink: 0;
    min-width: 90px;
  }

  .post-info a {
    font-weight: var(--weight-bold);
    color: var(--text-primary);
    text-decoration-color: rgba(255, 255, 255, 0.1);
  }

  .post-info a:hover {
    text-decoration-color: var(--color-accent);
    color: var(--color-accent);
  }

  .post-info p {
    font-size: 14px;
    color: var(--text-muted);
    margin: 2px 0 0;
  }

  @media (max-width: 640px) {
    .post-row {
      flex-direction: column;
      gap: 2px;
    }
  }
</style>
