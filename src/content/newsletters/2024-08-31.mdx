---
title: This Month in Ladybird - August 2024
description: ?
date: 2024-08-31
draft: true
---

Hello\!

### Welcoming new sponsors

Ladybird is funded entirely by sponsorships and donations from companies and individuals who care about the open web.

In August, weâ€™ve welcomed the following new sponsors:

- [Ahrefs](https://ahrefs.com/) with $50,000
- [Cling](http://cling.com) with $10,000
- [WorkOS](http://workos.com) with $10,000

### Skia now powers SVG and 2D canvas

We already talked last month about adopting Skia as our default rasterizer for high-performance 2D graphics.

This month, we've expanded our use of Skia beyond just HTML document rendering, and it now powers our `<canvas>` element, as well as SVG content! It also helps us render CSS borders faster and more correctly than before.

We've implemented all this as a set of classes with pluggable backends. This leaves the door open for using other graphics libraries in the future.

The main remaining work here is to enable GPU acceleration for 2D canvas graphics.

### `console.table()`

New contributor Gasim Gasimzada has been making improvements to our `console` API this month.
In particular, we were missing `console.table()`, which produces a table from the data passed in and prints it to the browser console.
At the time of writing, the [spec](https://console.spec.whatwg.org/#table) does not have an algorithm for this function,
so Gasim has [written one](https://github.com/whatwg/console/pull/237) and then implemented it in Ladybird.
Hopefully this algorithm will soon be made an official part of the spec, and help all browsers to behave consistently.

### CSS style values

Each CSS property's value is stored as one or more "style value" classes.
We have many of these, and until recently, they were very freeform and unrelated to any specs.
This month, we started moving these in line with the [CSS Typed OM spec](https://drafts.css-houdini.org/css-typed-om-1),
which defines a way for JavaScript to access styling as objects, instead of just strings.
So far, the main change is that we now store colors in whatever form they were written,
instead of converting them to a 32-bit RGBA value during parsing.
This means that using `calc()` inside a color function (such as `background-color: hsl(calc(15deg * 8) 50% 80%)`)
now finally works, which has been a problem for a long time!

### Retained display list

LibWeb's rendering process is divided into two stages.
The first stage involves building a list of draw commands (display list), and the second is the actual rasterization of the commands visible in the viewport from this list.
Until this month, the display list was built from scratch for each frame repaint.
The time required for building the display list depends on the size of the paintable tree, which caused slow repainting of pages with a lot of content, even though we could rasterize them relatively quickly.

This month, we took the first step towards improving this by reusing the display list across repaints if the only thing that requires invalidation is a scroll offset.
This is implemented by separating the display list into two parts:

- The list of draw commands, where each has an associated "scroll frame id"
- The list of scroll frames, where each frame has an id and scroll offset.

Before repainting, the display list is combined with the scroll offsets from the scroll frames list to produce the final draw commands, ready for rasterization.

| Resource                                                       | Before | After   |
| -------------------------------------------------------------- | ------ | ------- |
| [Zig Documentation](https://ziglang.org/documentation/master/) | 25 FPS | 120 FPS |
| [CSS Grid Layout Module](https://www.w3.org/TR/css-grid-2/)    | 60 FPS | 150 FPS |

### Use HarfBuzz for text layout and RTL support

Text layout is a process that takes a unicode string and available fonts as input and returns a list of positioned glyphs.
Until recently, we used our own basic text layout algorithm, which supported simple scripts like Latin and Cyrillic.
However, this month, BenJilks helped us transition to HarfBuzz and implemented support for the direction attribute.
With these two changes combined, Ladybird is now capable of rendering more complex scripts, such as Hebrew and Arabic.

### Alpha premultiplication

The painting process in Ladybird is responsible for displaying a web page's content to screen, and it needs to handle
many different bitmaps from all kinds of sources. An issue we had was that a partially transparent bitmap, such as a PNG
image or `<canvas>` target, would not blend onto other bitmaps in _quite_ the right way.

When dealing with alpha channels in bitmaps, there are two ways to deal with color data (i.e. the RGB channels): you can
either premultiply the color data with the alpha channel, or you can leave it alone. Premultiplying color data allows
for an optimization during blending, so it's a valid use case. Unfortunately, we were always assuming bitmap data
contains unpremultiplied color data, resulting in all kinds of ugly blending artifacts. On top of that, we didn't even
know what type of color data we were dealing with.

We started tracking the alpha type for each bitmap and now pass along this metadata to the Skia backend, getting rid of
these artifacts once and for all!

### Input selection API

Most text input elements such as `<input type="text">` and `<textarea>` have a DOM API to interact with their selection
state. With properties such as `.selectionStart` and `.selectionEnd` or methods such as `.select()`, you can
programmatically interact with the selection for an element.

Ladybird now implements these APIs almost fully according to spec and keeps the UI selection and element selection state
in sync!

### Web Platform Tests

This month has seen substantial progress on the Web Platform Tests!

We now have a dedicated server that runs the Web Platform Tests nightly. Our results are now published to the main
[wpt.fyi](https//wpt.fyi) dashboard, our latest results can be viewed [here](https://wpt.fyi/results/?product=ladybird).

The Web Platform tests can now be run locally using the `WPT.sh` script. This allows developers to ensure that their
changes don't cause regressions in the Web Platform Tests. The documentation for this script can be found
[here](https://github.com/LadybirdBrowser/ladybird/blob/master/Documentation/RunningTests.md#running-the-web-platform-tests).

WPT compliance has improved significantly this month in a number of areas, particularly our support for multi-byte
legacy text encodings thanks to a PR from BenJilks and our URL parsing support thanks to a series of PRs from
shannonbooth.

We currently pass 214,325 more subtests than this time last month with a total of 930,559 subtests now passing!

### New Security Policy

This month the project adopted a new security policy for reporting vulnerabilities.

In the past, our stance was that the project was pre-alpha and any security vulnerabilities in our code are not
security-critical. Therefore, security vulnerabilities should be treated as regular issues, and reported through our
standard GitHub issue tracker.

However, we've already seen how this policy won't work for us going forward. As we start using more and more open source
libraries, there's a chance that a vulnerability in a third party dependency is critical enough that the security
researchers want to notify all users with a relevant security policy. As we engage more with the wider browser
ecosystem, security researchers who find common vulnerabilities in web specifications, or implementations of web browser
features in other browsers may want to notify all web browsers at once. We have already had one security researcher
contact us with a vulnerability that affected all the other major browser engines, who wanted to ensure that we did not
have the same issue impacting our code.

As we move towards our alpha release, we want to encourage and acknowledge the invaluable service that security
researchers and bug hunters provide to the open source software community. Our new security posture has two main parts:

- We have enabled GitHub's [private vulnerability reporting](https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/privately-reporting-a-security-vulnerability)
  feature on the main ladybird repository.

- We have drafted a new [SECURITY.md](https://github.com/LadybirdBrowser/ladybird/blob/master/SECURITY.md) file to
  explain our expectations and goals for vulnerability reports

The pre-alpha and work in progress nature of the project means that we don't feel it's the right time to offer bug
bounties for discovered vulnerabilities. However, we will still publish [repository security advisories](https://docs.github.com/en/code-security/security-advisories/working-with-repository-security-advisories/about-repository-security-advisories)
for valid and in-scope vulnerabilities.

For more details on what we consider in-scope vulnerabilities and our new security policy in general, please see
the [SECURITY.md](https://github.com/LadybirdBrowser/ladybird/blob/master/SECURITY.md) file in our GitHub repository.
We welcome any and all feedback on the policy to help encourage researchers to investigate our code and to clear up
any possibly confusing clauses.

### Credits

We thank the following people who contributed code to Ladybird in August 2024:

_list,
of,
people_
